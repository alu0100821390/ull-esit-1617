
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Mongoose · GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.1.1">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-sectionx/sectionx.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../../../repasos/" />
    
    
    <link rel="prev" href="mongodb.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../instrucciones/">
            
                <a href="../../../instrucciones/">
            
                    
                    Instrucciones Generales
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../../instrucciones/classroom.html">
            
                <a href="../../../instrucciones/classroom.html">
            
                    
                    Instrucciones para GitHub ClassRoom
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../../instrucciones/instruccionesparaelenvio.html">
            
                <a href="../../../instrucciones/instruccionesparaelenvio.html">
            
                    
                    Instrucciones para los envíos de tareas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../../instrucciones/instruccionesparalaevaluacion.html">
            
                <a href="../../../instrucciones/instruccionesparalaevaluacion.html">
            
                    
                    Instrucciones para la evaluación
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../../instrucciones/instruccionesparalaspresentaciones.html">
            
                <a href="../../../instrucciones/instruccionesparalaspresentaciones.html">
            
                    
                    Instrucciones para las Presentaciones de SYTW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../">
            
                <a href="../../">
            
                    
                    Apuntes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../github/">
            
                <a href="../../github/">
            
                    
                    GitHub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../gulp/">
            
                <a href="../../gulp/">
            
                    
                    Gulp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../gulp/gulpghpages.html">
            
                <a href="../../gulp/gulpghpages.html">
            
                    
                    gulp gh pages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../gulp/gulplinting.html">
            
                <a href="../../gulp/gulplinting.html">
            
                    
                    gulp-linting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../nodejspackages.html">
            
                <a href="../../nodejspackages.html">
            
                    
                    Creación de Paquetes y Módulos en NodeJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../gitbooknotes/">
            
                <a href="../../gitbooknotes/">
            
                    
                    Sobre GitBook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../../fs.html">
            
                <a href="../../fs.html">
            
                    
                    Sistema de Archivos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../../argumentos/">
            
                <a href="../../argumentos/">
            
                    
                    Procesamiento de la línea de comandos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../../colaboracion/">
            
                <a href="../../colaboracion/">
            
                    
                    Colaboración
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../../express/">
            
                <a href="../../express/">
            
                    
                    Express
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../../processes/">
            
                <a href="../../processes/">
            
                    
                    Procesos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../../patterns/codesmell.html">
            
                <a href="../../patterns/codesmell.html">
            
                    
                    Code Smells
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../../patterns/designprinciples.html">
            
                <a href="../../patterns/designprinciples.html">
            
                    
                    Principios de Diseño
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../../patterns/">
            
                <a href="../../patterns/">
            
                    
                    Patrones de Diseño
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.12.1" data-path="../../patterns/strategypattern.html">
            
                <a href="../../patterns/strategypattern.html">
            
                    
                    Strategy Pattern
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12.2" data-path="../../patterns/dependencyinjectionpattern.html">
            
                <a href="../../patterns/dependencyinjectionpattern.html">
            
                    
                    Dependency Injection Pattern
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12.3" data-path="../../patterns/inversionofcontrolpattern.html">
            
                <a href="../../patterns/inversionofcontrolpattern.html">
            
                    
                    Inversion of Control Pattern
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="../../rest/">
            
                <a href="../../rest/">
            
                    
                    Arquitectura REST y REST APIs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.13.1" data-path="../../rest/githubapitutorial.html">
            
                <a href="../../rest/githubapitutorial.html">
            
                    
                    Getting Started with the GitHub API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.14" data-path="../../authentication/">
            
                <a href="../../authentication/">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.15" data-path="../../ssl/">
            
                <a href="../../ssl/">
            
                    
                    SSL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.16" data-path="../">
            
                <a href="../">
            
                    
                    Bases de Datos/DataBases
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.16.1" data-path="../sqlite/">
            
                <a href="../sqlite/">
            
                    
                    Sqlite
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.16.2" data-path="../sequelize/">
            
                <a href="../sequelize/">
            
                    
                    Sequelize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.16.3" data-path="./">
            
                <a href="./">
            
                    
                    Mongo
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.16.3.1" data-path="mongodb.html">
            
                <a href="mongodb.html">
            
                    
                    MongoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.16.3.2" data-path="mongoose.html">
            
                <a href="mongoose.html">
            
                    
                    Mongoose
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../repasos/">
            
                <a href="../../../repasos/">
            
                    
                    Repasos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../../recursos/">
            
                <a href="../../../recursos/">
            
                    
                    Recursos
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../../recursos/">
            
                <a href="../../../recursos/#github-education">
            
                    
                    GitHub Education
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" >
            
                <span>
            
                    
                    Servicios en la Nube
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../../../recursos/iaas.html">
            
                <a href="../../../recursos/iaas.html">
            
                    
                    iaas.ull.es
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../../../recursos/heroku.html">
            
                <a href="../../../recursos/heroku.html">
            
                    
                    Heroku
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../../../recursos/yellow.html">
            
                <a href="../../../recursos/yellow.html">
            
                    
                    Yellow Circle
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../../practicas/">
            
                <a href="../../../practicas/">
            
                    
                    Prácticas
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../../practicas/practicagitbook.html">
            
                <a href="../../../practicas/practicagitbook.html">
            
                    
                    Práctica: Tareas Iniciales
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../../practicas/practicaoop.html">
            
                <a href="../../../practicas/practicaoop.html">
            
                    
                    Práctica: OOP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../../practicas/practicanm.html">
            
                <a href="../../../practicas/practicanm.html">
            
                    
                    Práctica: Creación de un Paquete NPM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../../../practicas/practicaiaas.html">
            
                <a href="../../../practicas/practicaiaas.html">
            
                    
                    Práctica: Despliegues en iaas y heroku
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../../../practicas/practicaplugin.html">
            
                <a href="../../../practicas/practicaplugin.html">
            
                    
                    Práctica: Añadiendo plugins para los despliegues. iaas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../../../practicas/practicaplugin2.html">
            
                <a href="../../../practicas/practicaplugin2.html">
            
                    
                    Práctica: gitbook-start. Plugin para heroku
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../../../practicas/practicagithubapi.html">
            
                <a href="../../../practicas/practicagithubapi.html">
            
                    
                    Práctica: GitHub API, Heroku API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../../../practicas/practicapassport.html">
            
                <a href="../../../practicas/practicapassport.html">
            
                    
                    Práctica: Autenticación OAuth con Passport
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../../../practicas/practicapassportlocal.html">
            
                <a href="../../../practicas/practicapassportlocal.html">
            
                    
                    Práctica: Passport y LocalStrategy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../../../practicas/practicapassportlocalsequelize.html">
            
                <a href="../../../practicas/practicapassportlocalsequelize.html">
            
                    
                    Práctica: LocalStrategy y Base de Datos: LocalStrategy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="../../../practicas/practicassl.html">
            
                <a href="../../../practicas/practicassl.html">
            
                    
                    Práctica: Añadir HTTPS al servidor del libro
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Mongoose</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <!-- toc -->
<h3 id="mongoose">Mongoose</h3>
<p>Mongoose is a Node.js module that:</p>
<ul>
<li>It works as a client for MongoDB </li>
<li>Is a data modeling tool, which allows us to represent documents as objects in our programs</li>
</ul>
<h4 id="data-model">Data Model</h4>
<p>A data model is simply an <strong>object representation</strong> of a collection of documents in a data store. 
In addition to specifying the fields that are in every document of a collection, it adds MongoDB database operations like <code>save</code> and <code>find</code> to the associated objects.</p>
<ul>
<li>Models are fancy constructors compiled from our Schema definitions. </li>
<li>Instances of these models represent documents which can be saved and retrieved from our database. </li>
<li>All document creation and retrieval from the database is handled by these models.</li>
</ul>
<h4 id="schema">Schema</h4>
<p>In Mongoose, a data model consists of a schema, which describes the structure of all of the objects that are of that type. 
Each schema maps to a MongoDB collection and defines the shape of the documents within that collection.</p>
<p>Suppose we want to create a data model for a collection of playing cards. 
We&#x2019;d start by specifying the schema for a card
explicitly declaring that every card has a rank and a suit:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> CardSchema = mongoose.Schema({ 
        <span class="hljs-string">&quot;rank&quot;</span> : <span class="hljs-built_in">String</span>,
        <span class="hljs-string">&quot;suit&quot;</span> : <span class="hljs-built_in">String</span>
    });
</code></pre>
<p>Schemas can get more complicated. For example, we might build a schema for blog posts that contain dates and comments. In this example, the <code>comments</code> attribute represents an array of strings instead of a single one:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> BlogPostSchema = mongoose.Schema({ 
        title: <span class="hljs-built_in">String</span>,
        body : <span class="hljs-built_in">String</span>,
        date : <span class="hljs-built_in">Date</span>,
        comments : [ <span class="hljs-built_in">String</span> ]
});
</code></pre>
<p>or even more complicated:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>);
<span class="hljs-keyword">var</span> Schema = mongoose.Schema;

<span class="hljs-keyword">var</span> blogSchema = <span class="hljs-keyword">new</span> Schema({
  title:  <span class="hljs-built_in">String</span>,
  author: <span class="hljs-built_in">String</span>,
  body:   <span class="hljs-built_in">String</span>,
  comments: [{ body: <span class="hljs-built_in">String</span>, date: <span class="hljs-built_in">Date</span> }],
  date: { type: <span class="hljs-built_in">Date</span>, <span class="hljs-keyword">default</span>: <span class="hljs-built_in">Date</span>.now },
  hidden: <span class="hljs-built_in">Boolean</span>,
  meta: {
    votes: <span class="hljs-built_in">Number</span>,
    favs:  <span class="hljs-built_in">Number</span>
  }
});
</code></pre>
<p>The permitted SchemaTypes are</p>
<ul>
<li><code>String</code></li>
<li><code>Number</code></li>
<li><code>Date</code></li>
<li><code>Buffer</code></li>
<li><code>Boolean</code></li>
<li><code>Mixed</code></li>
<li><code>ObjectId</code></li>
<li><code>Array</code></li>
</ul>
<p>Mongoose assigns each of your schemas an <code>_id</code> field by default 
if one is not passed into the Schema constructor. 
The type assigned is an <a href="http://mongoosejs.com/docs/api.html#schema_Schema.Types" target="_blank">ObjectId</a> 
to coincide with MongoDB&apos;s default behavior. </p>
<h4 id="building-a-model-from-a-schema">Building a Model from a Schema</h4>
<p>Once we create the schema, building a model is very easy. By convention, we use a capital letter for data model objects:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> Card = mongoose.model(<span class="hljs-string">&quot;Card&quot;</span>, CardSchema);
</code></pre>
<ul>
<li>The first argument is the singular name of the collection your model is for. </li>
<li><strong> Mongoose automatically looks for the plural version of your model name</strong>. <ul>
<li>Thus, for the example above, the model <code>Card</code> is for the <code>cards</code> collection in the database. </li>
</ul>
</li>
<li>The <code>.model()</code> function makes a copy of schema. </li>
<li>Make sure that you&apos;ve added everything you want to schema before calling <code>.model()</code>!</li>
</ul>
<p>Every model has an associated connection. When you use <code>mongoose.model()</code>, your model will use the default mongoose connection.</p>
<pre><code class="lang-javascript">mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/chuchu&apos;</span>);
</code></pre>
<pre><code class="lang-javascript">mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/test&apos;</span>, (err)=&gt; {
  <span class="hljs-keyword">if</span>(err) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Error: Check if mongod is running!!&quot;</span>);
    <span class="hljs-built_in">console</span>.log(err);
    <span class="hljs-keyword">throw</span> err;
  }
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Connected to MongoDB&quot;</span>);
});
</code></pre>
<h4 id="constructing-documents">Constructing documents</h4>
<p>Once we have a model, we can create an object of the model type very easily using JavaScript&#x2019;s <code>new</code> operator. </p>
<p>For example, this line of code creates the ace of spades and stores it in a variable called <code>c1</code>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> c1 = <span class="hljs-keyword">new</span> Card({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;ace&quot;</span>, <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;spades&quot;</span>});
</code></pre>
<p><code>mongoose</code> adds a property whose name is <code>__v</code> as this <code>mongo</code> session shows:</p>
<pre><code class="lang-javascript">&gt; show dbs
chuchu       <span class="hljs-number">0.078</span>GB
&gt; use chuchu
switched to db chuchu
&gt; show collections
cards
system.indexes
&gt; db.cards.find()
{ <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;570e874722bc0fbc916dc90a&quot;</span>), <span class="hljs-string">&quot;rank&quot;</span> : <span class="hljs-string">&quot;ace&quot;</span>, <span class="hljs-string">&quot;suit&quot;</span> : <span class="hljs-string">&quot;spades&quot;</span>, <span class="hljs-string">&quot;__v&quot;</span> : <span class="hljs-number">0</span> }
</code></pre>
<p>The <code>versionKey</code> is a property set on each document when first created by Mongoose. This keys value contains the internal revision of the document. The <code>versionKey</code> option is a string that represents the path to use for versioning. The default is <code>__v</code>. </p>
<h4 id="saving-documents">Saving Documents</h4>
<p>Saving documents to the database is easy:</p>
<pre><code class="lang-javascript">c1.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
  <span class="hljs-comment">// saved!</span>
})
</code></pre>
<p>or</p>
<pre><code class="lang-javascript">Card.create({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;ace&quot;</span>, <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;spades&quot;</span>}), <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, c1</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
  <span class="hljs-comment">// saved!</span>
})
</code></pre>
<p>Note that no cards will be created/removed until the connection your model uses is open. </p>
<h4 id="los-m&#xE9;todos-save-retornan-promesas">Los m&#xE9;todos <code>save</code> retornan Promesas</h4>
<p>Ambos <code>save</code> y <code>create</code> retornan objetos <a href="http://mongoosejs.com/docs/promises.html" target="_blank">Promise</a>.
V&#xE9;ase el siguiente ejemplo en el que se guardan varios objetos y luego se cierra la conexi&#xF3;n con la base de datos. Debemos garantizar que la conexi&#xF3;n es cerrada despu&#xE9;s que se guarden todos los objetos.
Si usamos manejadores de eventos nos meteremos en un buen l&#xED;o. La soluci&#xF3;n es usar las promesas:</p>
<pre><code class="lang-javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  &quot;use strict&quot;</span>;
  <span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;util&apos;</span>);
  <span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>);

  mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/chuchu&apos;</span>);
  <span class="hljs-keyword">const</span> CardSchema = mongoose.Schema({ 
    <span class="hljs-string">&quot;rank&quot;</span> : <span class="hljs-built_in">String</span>,
    <span class="hljs-string">&quot;suit&quot;</span> : <span class="hljs-built_in">String</span>,
    <span class="hljs-string">&quot;chuchu&quot;</span>: [ {a: <span class="hljs-built_in">String</span>, b: <span class="hljs-built_in">String</span>}]
  });

  <span class="hljs-keyword">const</span> Card = mongoose.model(<span class="hljs-string">&quot;Card&quot;</span>, CardSchema);

  <span class="hljs-keyword">let</span> c1 = <span class="hljs-keyword">new</span> Card({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;ace&quot;</span>, <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;spades &#x2660;&quot;</span>,   <span class="hljs-string">&quot;chuchu&quot;</span>: [{a: <span class="hljs-string">&quot;hello&quot;</span>, b: <span class="hljs-string">&quot;world!&quot;</span>}]});
  <span class="hljs-keyword">let</span> c2 = <span class="hljs-keyword">new</span> Card({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;2&quot;</span>,   <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;hearts &#x2665;&quot;</span>,   <span class="hljs-string">&quot;chuchu&quot;</span>: [{a: <span class="hljs-string">&quot;hola&quot;</span>, b: <span class="hljs-string">&quot;mundo&quot;</span>}]});
  <span class="hljs-keyword">let</span> c3 = <span class="hljs-keyword">new</span> Card({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>,   <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;clubs &#x2663;&quot;</span>,    <span class="hljs-string">&quot;chuchu&quot;</span>: [{a: <span class="hljs-string">&quot;hola&quot;</span>, b: <span class="hljs-string">&quot;mundo&quot;</span>}]});
  <span class="hljs-keyword">let</span> c4 = <span class="hljs-keyword">new</span> Card({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;4&quot;</span>,   <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;diamonds &#x2666;&quot;</span>, <span class="hljs-string">&quot;chuchu&quot;</span>: [{a: <span class="hljs-string">&quot;hola&quot;</span>, b: <span class="hljs-string">&quot;mundo&quot;</span>}]});


  <span class="hljs-keyword">let</span> p1 = c1.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
    <span class="hljs-keyword">if</span> (err) { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hubieron errores:\n<span class="hljs-subst">${err}</span>`</span>); <span class="hljs-keyword">return</span> err; }
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Saved: <span class="hljs-subst">${c1}</span>`</span>);
  });

  <span class="hljs-keyword">let</span> p2 = c2.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
    <span class="hljs-keyword">if</span> (err) { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hubieron errores:\n<span class="hljs-subst">${err}</span>`</span>); <span class="hljs-keyword">return</span> err; }
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Saved: <span class="hljs-subst">${c2}</span>`</span>);
  });

  <span class="hljs-keyword">let</span> p3 = Card.create(c3, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, x</span>) </span>{
    <span class="hljs-keyword">if</span> (err) { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hubieron errores:\n<span class="hljs-subst">${err}</span>`</span>); <span class="hljs-keyword">return</span> err; }
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Saved p3: <span class="hljs-subst">${x}</span>`</span>);
  });

  <span class="hljs-built_in">Promise</span>.all([p1, p2, p3]).then( (value) =&gt; { 
    <span class="hljs-built_in">console</span>.log(util.inspect(value, {depth: <span class="hljs-literal">null</span>}));  
    mongoose.connection.close(); 
  });
})();
</code></pre>
<p>cuando se ejecuta este programa produce la siguiente salida:</p>
<pre><code class="lang-bash">[~/javascript/mongoose/hello]$ node hello-cards.js 
Saved: { chuchu: [ { _id: 570fe42c8f5fb2f208a8c756, b: <span class="hljs-string">&apos;world!&apos;</span>, a: <span class="hljs-string">&apos;hello&apos;</span> } ],
  _id: 570fe42c8f5fb2f208a8c755,
  suit: <span class="hljs-string">&apos;spades &#x2660;&apos;</span>,
  rank: <span class="hljs-string">&apos;ace&apos;</span>,
  __v: 0 }
Saved: { chuchu: [ { _id: 570fe42c8f5fb2f208a8c758, b: <span class="hljs-string">&apos;mundo&apos;</span>, a: <span class="hljs-string">&apos;hola&apos;</span> } ],
  _id: 570fe42c8f5fb2f208a8c757,
  suit: <span class="hljs-string">&apos;hearts &#x2665;&apos;</span>,
  rank: <span class="hljs-string">&apos;2&apos;</span>,
  __v: 0 }
Saved p3: { chuchu: [ { _id: 570fe42c8f5fb2f208a8c75a, b: <span class="hljs-string">&apos;mundo&apos;</span>, a: <span class="hljs-string">&apos;hola&apos;</span> } ],
  rank: <span class="hljs-string">&apos;3&apos;</span>,
  suit: <span class="hljs-string">&apos;clubs &#x2663;&apos;</span>,
  _id: 570fe42c8f5fb2f208a8c759,
  __v: 0 }
[ { chuchu: [ { _id: 570fe42c8f5fb2f208a8c756, b: <span class="hljs-string">&apos;world!&apos;</span>, a: <span class="hljs-string">&apos;hello&apos;</span> } ],
    _id: 570fe42c8f5fb2f208a8c755,
    suit: <span class="hljs-string">&apos;spades &#x2660;&apos;</span>,
    rank: <span class="hljs-string">&apos;ace&apos;</span>,
    __v: 0 },
  { chuchu: [ { _id: 570fe42c8f5fb2f208a8c758, b: <span class="hljs-string">&apos;mundo&apos;</span>, a: <span class="hljs-string">&apos;hola&apos;</span> } ],
    _id: 570fe42c8f5fb2f208a8c757,
    suit: <span class="hljs-string">&apos;hearts &#x2665;&apos;</span>,
    rank: <span class="hljs-string">&apos;2&apos;</span>,
    __v: 0 },
  { chuchu: [ { _id: 570fe42c8f5fb2f208a8c75a, b: <span class="hljs-string">&apos;mundo&apos;</span>, a: <span class="hljs-string">&apos;hola&apos;</span> } ],
    rank: <span class="hljs-string">&apos;3&apos;</span>,
    suit: <span class="hljs-string">&apos;clubs &#x2663;&apos;</span>,
    _id: 570fe42c8f5fb2f208a8c759,
    __v: 0 } ]
</code></pre>
<ul>
<li><a href="https://gist.github.com/crguezl/39f8d635917f7a3b5164a817ef65095b" target="_blank">Gist en GitHub</a></li>
<li><a href="https://gist.github.com/39f8d635917f7a3b5164a817ef65095b.git" target="_blank">Clonar gist con este c&#xF3;digo</a></li>
</ul>
<pre><code class="lang-bash">[~/javascript/mongoose/hello/mongoosepromisesexample(master)]$ <span class="hljs-built_in">pwd</span> -P
/Users/casiano/<span class="hljs-built_in">local</span>/src/javascript/mongoose/hello/mongoosepromisesexample
</code></pre>
<h4 id="queries-en-mongoose">Queries en Mongoose</h4>
<p>We can also interact directly with the model to pull items out of the database using the <code>find</code> function that&#x2019;s part of the data model. Like the <code>find</code> function in the interactive
MongoDB client, this function takes in an arbitrary MongoDB query. The difference is that it restricts itself to the types that are defined by the model:</p>
<pre><code class="lang-javascript">  <span class="hljs-keyword">let</span> c1, c2, c3, c4;
  Card.remove().then( () =&gt; {
    c1 = <span class="hljs-keyword">new</span> Card({<span class="hljs-string">&quot;rank&quot;</span>:<span class="hljs-string">&quot;ace&quot;</span>, <span class="hljs-string">&quot;suit&quot;</span>:<span class="hljs-string">&quot;spades &#x2660;&quot;</span>   });
    <span class="hljs-comment">/* ... as before ... */</span>
    <span class="hljs-keyword">let</span> p4 = <span class="hljs-built_in">Promise</span>.all([p1, p2, p3]).then( (value) =&gt; { 
      Card.find({}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, cards</span>) </span>{ 
        <span class="hljs-keyword">if</span> (err) { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;ERROR: &quot;</span> + err); }
        <span class="hljs-keyword">let</span> c = <span class="hljs-number">1</span>;
        cards.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">card</span>) </span>{
          <span class="hljs-built_in">console</span>.log (<span class="hljs-string">`<span class="hljs-subst">${c++}</span>: <span class="hljs-subst">${card.rank}</span> of <span class="hljs-subst">${card.suit}</span>`</span>);
        }); 
      }).then( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ mongoose.connection.close(); } );  
    });
</code></pre>
<p>(<a href="https://gist.github.com/crguezl/c706121ee8f5cdae99d0061bccfe1d60" target="_blank">V&#xE9;ase el Gist con el c&#xF3;digo completo</a>)</p>
<p>In mongoose 4, a Query has a <code>.then()</code> function, and thus can be used as a promise.</p>
<p>Any model method which involves specifying query conditions can be executed two ways:</p>
<p>When a <code>callback</code> function:</p>
<ul>
<li><strong>is passed</strong>, the operation will be executed immediately with the results passed to the <code>callback</code>.</li>
<li><strong>is not passed</strong>, an instance of <a href="http://mongoosejs.com/docs/api.html#query-js" target="_blank">Query</a> is returned, which provides a special query builder interface.</li>
</ul>
<p>When executing a query with a <code>callback</code> function, you specify your query as a JSON document. The JSON document&apos;s syntax is the same as the <a href="https://docs.mongodb.org/manual/tutorial/query-documents/" target="_blank">MongoDB shell</a>.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> Person = mongoose.model(<span class="hljs-string">&apos;Person&apos;</span>, yourSchema);

<span class="hljs-comment">// find each person with a last name matching &apos;Ghost&apos;, selecting the `name` and `occupation` fields</span>
Person.findOne({ <span class="hljs-string">&apos;name.last&apos;</span>: <span class="hljs-string">&apos;Ghost&apos;</span> }, <span class="hljs-string">&apos;name occupation&apos;</span>, 
  <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, person</span>) </span>{
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;%s %s is a %s.&apos;</span>, person.name.first, person.name.last, person.occupation) <span class="hljs-comment">// Space Ghost is a talk show host.</span>
  })
</code></pre>
<p>Now let&apos;s look at what happens when no callback is passed:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// find each person with a last name matching &apos;Ghost&apos;</span>
<span class="hljs-keyword">var</span> query = Person.findOne({ <span class="hljs-string">&apos;name.last&apos;</span>: <span class="hljs-string">&apos;Ghost&apos;</span> });

<span class="hljs-comment">// selecting the `name` and `occupation` fields</span>
query.select(<span class="hljs-string">&apos;name occupation&apos;</span>);

<span class="hljs-comment">// execute the query at a later time</span>
query.exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, person</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;%s %s is a %s.&apos;</span>, person.name.first, person.name.last, person.occupation) <span class="hljs-comment">// Space Ghost is a talk show host.</span>
})
</code></pre>
<p>In the above code, the query variable is of type <a href="http://mongoosejs.com/docs/api.html#query-js" target="_blank">Query</a>. A <a href="http://mongoosejs.com/docs/api.html#query-js" target="_blank">Query</a> enables you to build up a query using chaining syntax, rather than specifying a JSON object. </p>
<p>A full example can be found in this <a href="https://gist.github.com/crguezl/165cfec398c5576b6d4d88f3e4b6f204" target="_blank">gist</a>.</p>
<p>The below 2 examples are equivalent.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// With a JSON doc</span>
Person.
  find({
    occupation: <span class="hljs-regexp">/host/</span>,
    <span class="hljs-string">&apos;name.last&apos;</span>: <span class="hljs-string">&apos;Ghost&apos;</span>,
    age: { $gt: <span class="hljs-number">17</span>, $lt: <span class="hljs-number">66</span> },
    likes: { $<span class="hljs-keyword">in</span>: [<span class="hljs-string">&apos;vaporizing&apos;</span>, <span class="hljs-string">&apos;talking&apos;</span>] }
  }).
  limit(<span class="hljs-number">10</span>).
  sort({ occupation: <span class="hljs-number">-1</span> }).
  select({ name: <span class="hljs-number">1</span>, occupation: <span class="hljs-number">1</span> }).
  exec(callback);

<span class="hljs-comment">// Using query builder</span>
Person.
  find({ occupation: <span class="hljs-regexp">/host/</span> }).
  where(<span class="hljs-string">&apos;name.last&apos;</span>).equals(<span class="hljs-string">&apos;Ghost&apos;</span>).
  where(<span class="hljs-string">&apos;age&apos;</span>).gt(<span class="hljs-number">17</span>).lt(<span class="hljs-number">66</span>).
  where(<span class="hljs-string">&apos;likes&apos;</span>).in([<span class="hljs-string">&apos;vaporizing&apos;</span>, <span class="hljs-string">&apos;talking&apos;</span>]).
  limit(<span class="hljs-number">10</span>).
  sort(<span class="hljs-string">&apos;-occupation&apos;</span>).
  select(<span class="hljs-string">&apos;name occupation&apos;</span>).
  exec(callback);
</code></pre>
<p>A full list of <a href="http://mongoosejs.com/docs/api.html#query-js" target="_blank">Query helper functions can be found in the API docs</a>.</p>
<h5 id="queries-v&#xE9;ase">Queries: V&#xE9;ase</h5>
<ul>
<li><a href="http://mongoosejs.com/docs/queries.html" target="_blank">Mongoose Docs: Queries</a></li>
</ul>
<h4 id="mongoose-validaciones">Mongoose Validaciones</h4>
<p>One of the core concepts of Mongoose is that it enforces a schema on top of a schema-less design such as MongoDB. 
In doing so, we gain a number of new features, including built-in validation. 
By default, every schema type has a built-in required validator available. </p>
<p>Furthermore, numbers have both min and max validators and strings have enumeration and matching validators</p>
<p>Validation will  re automatically whenever a model&apos;s <code>.save()</code> function is called; 
however, you can also manually validate by calling a model&apos;s <code>.validate()</code> function 
with a callback to handle the response.</p>
<ul>
<li>V&#xE9;ase <a href="http://mongoosejs.com/docs/validation.html" target="_blank">la documentaci&#xF3;n de Mongoose sobre Validaciones</a></li>
</ul>
<h5 id="ejemplo-de-validaci&#xF3;n-de-n&#xFA;meros">Ejemplo de Validaci&#xF3;n de N&#xFA;meros</h5>
<pre><code class="lang-javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  &quot;use strict&quot;</span>;
  <span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;util&apos;</span>);
  <span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>);

  mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/tutu&apos;</span>);
  <span class="hljs-keyword">const</span> ScoreSchema = mongoose.Schema({ 
    <span class="hljs-string">&quot;name&quot;</span> : { type: <span class="hljs-built_in">String</span>, required: <span class="hljs-literal">true</span> },
    <span class="hljs-string">&quot;cal&quot;</span> : { type: <span class="hljs-built_in">Number</span>, required: <span class="hljs-literal">true</span>, min: <span class="hljs-number">0</span>, max: <span class="hljs-number">10</span> }
  });

  <span class="hljs-keyword">const</span> Score = mongoose.model(<span class="hljs-string">&quot;Score&quot;</span>, ScoreSchema);

  Score.remove().then( () =&gt; {
    <span class="hljs-keyword">let</span> c = [ <span class="hljs-keyword">new</span> Score({<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;Juana&quot;</span>,   <span class="hljs-string">&quot;cal&quot;</span>:<span class="hljs-number">10</span>   }),
         <span class="hljs-keyword">new</span> Score({<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;Pedro&quot;</span>,   <span class="hljs-string">&quot;cal&quot;</span>:<span class="hljs-number">3</span> }),
         <span class="hljs-keyword">new</span> Score({<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;Maria&quot;</span>,   <span class="hljs-string">&quot;cal&quot;</span>:<span class="hljs-number">5</span> }),
         <span class="hljs-keyword">new</span> Score({<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;Antonio&quot;</span>, <span class="hljs-string">&quot;cal&quot;</span>:<span class="hljs-number">12</span> })];


    <span class="hljs-keyword">let</span> p = [];
    c.forEach( (n, i) =&gt; {
      p[i] = n.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
        <span class="hljs-keyword">if</span> (err) { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hubieron errores salvando <span class="hljs-subst">${n}</span>:\n<span class="hljs-subst">${err}</span>`</span>); <span class="hljs-keyword">return</span> err; }
      });
    });

    <span class="hljs-keyword">let</span> p5 = <span class="hljs-built_in">Promise</span>.all(p).then( (value) =&gt; { 
      <span class="hljs-keyword">let</span> query = Score.find({cal: {$lte: <span class="hljs-number">10</span>, $gte: <span class="hljs-number">5</span>}});
      query.select(<span class="hljs-string">&apos;name cal&apos;</span>);
      query.exec((err, notas) =&gt; { 
        <span class="hljs-keyword">if</span> (err) { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;ERROR: &quot;</span> + err); }
        <span class="hljs-keyword">let</span> c = <span class="hljs-number">1</span>;
        notas.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nota</span>) </span>{
          <span class="hljs-built_in">console</span>.log (<span class="hljs-string">`<span class="hljs-subst">${c++}</span>: <span class="hljs-subst">${nota.name}</span> of <span class="hljs-subst">${nota.cal}</span>`</span>);
        }); 
      }).then( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ mongoose.connection.close(); } );  
    },
    (err) =&gt; {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Grrr!!! Ocurrieron errores! &lt;<span class="hljs-subst">${err}</span>&gt;`</span>);
      mongoose.connection.close();   
    }
    );
  });
})();
</code></pre>
<p>Cuando se ejecuta este programa produce una salida como esta:</p>
<pre><code class="lang-javascript">[~<span class="hljs-regexp">/local/</span>src/javascript/mongoose/hello/mongoosevalidation(master)]$ node mongoosevalidation.js 
Hubieron errores salvando { _id: <span class="hljs-number">5715544</span>dc02f40826891f8f8, cal: <span class="hljs-number">12</span>, name: <span class="hljs-string">&apos;Antonio&apos;</span> }:
ValidationError: Path <span class="hljs-string">`cal`</span> (<span class="hljs-number">12</span>) is more than maximum allowed value (<span class="hljs-number">10</span>).
Grrr!!! Ocurrieron errores! <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ValidationError:</span> <span class="hljs-attr">Path</span> `<span class="hljs-attr">cal</span>` (<span class="hljs-attr">12</span>) <span class="hljs-attr">is</span> <span class="hljs-attr">more</span> <span class="hljs-attr">than</span> <span class="hljs-attr">maximum</span> <span class="hljs-attr">allowed</span> <span class="hljs-attr">value</span> (<span class="hljs-attr">10</span>)<span class="hljs-attr">.</span>&gt;</span>
Hubieron errores salvando { _id: 5715544dc02f40826891f8f5, cal: 10, name: &apos;Juana&apos;, __v: 0 }:
MongoError: server localhost:27017 sockets closed
Hubieron errores salvando { _id: 5715544dc02f40826891f8f6, cal: 3, name: &apos;Pedro&apos;, __v: 0 }:
MongoError: server localhost:27017 sockets closed
Hubieron errores salvando { _id: 5715544dc02f40826891f8f7, cal: 5, name: &apos;Maria&apos;, __v: 0 }:
MongoError: server localhost:27017 sockets closed
</span></code></pre>
<h5 id="ejemplo-de-validaci&#xF3;n-de-strings">Ejemplo de Validaci&#xF3;n de Strings</h5>
<p>Este otro ejemplo muestra como construir un validador para un atributo del tipo <code>String</code>:</p>
<pre><code class="lang-javascript"><span class="hljs-meta">  &quot;use strict&quot;</span>;
  <span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;util&apos;</span>);
  <span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;assert&apos;</span>);
  <span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>);

  mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/tutu&apos;</span>);

    <span class="hljs-keyword">var</span> toySchema = <span class="hljs-keyword">new</span> mongoose.Schema({
      color: <span class="hljs-built_in">String</span>,
      name: <span class="hljs-built_in">String</span>
    });

    <span class="hljs-keyword">var</span> Toy = mongoose.model(<span class="hljs-string">&apos;Toy&apos;</span>, toySchema);

    <span class="hljs-keyword">var</span> validator = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-regexp">/blue|green|white|red|orange|periwinkle/i</span>.test(value);
    };
    Toy.schema.path(<span class="hljs-string">&apos;color&apos;</span>).validate(validator,
      <span class="hljs-string">&apos;Color `{VALUE}` not valid&apos;</span>, <span class="hljs-string">&apos;Invalid color&apos;</span>);

    <span class="hljs-keyword">var</span> toy = <span class="hljs-keyword">new</span> Toy({ color: <span class="hljs-string">&apos;grease&apos;</span>});

    toy.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
      <span class="hljs-comment">// err is our ValidationError object</span>
      <span class="hljs-comment">// err.errors.color is a ValidatorError object</span>
      <span class="hljs-built_in">console</span>.log(err);

      assert.equal(err.errors.color.message, <span class="hljs-string">&apos;Color `grease` not valid&apos;</span>);
      assert.equal(err.errors.color.kind, <span class="hljs-string">&apos;Invalid color&apos;</span>);
      assert.equal(err.errors.color.path, <span class="hljs-string">&apos;color&apos;</span>);
      assert.equal(err.errors.color.value, <span class="hljs-string">&apos;grease&apos;</span>);
      assert.equal(err.name, <span class="hljs-string">&apos;ValidationError&apos;</span>);

      mongoose.connection.close();   
    });
</code></pre>
<h5 id="validaciones-pre-constru&#xED;das">Validaciones Pre Constru&#xED;das</h5>
<p>Mongoose has several built-in validators.</p>
<p>All SchemaTypes have the built-in required validator. </p>
<ul>
<li><code>Numbers</code> have <code>min</code> and <code>max</code> validators.</li>
<li><code>Strings</code> have <code>enum</code>, <code>match</code>, <code>maxlength</code> and <code>minlength</code> validators.</li>
</ul>
<pre><code class="lang-javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  &quot;use strict&quot;</span>;
  <span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;util&apos;</span>);
  <span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;assert&apos;</span>);
  <span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>);

  mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/tutu&apos;</span>);

  <span class="hljs-keyword">const</span> breakfastSchema = <span class="hljs-keyword">new</span> mongoose.Schema({
    eggs: {
      type: <span class="hljs-built_in">Number</span>,
      min: [<span class="hljs-number">6</span>, <span class="hljs-string">&apos;Too few eggs&apos;</span>],
      max: <span class="hljs-number">12</span>
    },
    bacon: {
      type: <span class="hljs-built_in">Number</span>,
      required: [<span class="hljs-literal">true</span>, <span class="hljs-string">&apos;Why no bacon?&apos;</span>]
    },
    drink: {
      type: <span class="hljs-built_in">String</span>,
      enum: [<span class="hljs-string">&apos;Coffee&apos;</span>, <span class="hljs-string">&apos;Tea&apos;</span>]
    }
  });
  <span class="hljs-keyword">const</span> Breakfast = mongoose.model(<span class="hljs-string">&apos;Breakfast&apos;</span>, breakfastSchema);

  <span class="hljs-keyword">let</span> badBreakfast = <span class="hljs-keyword">new</span> Breakfast({
    eggs: <span class="hljs-number">2</span>,
    bacon: <span class="hljs-number">0</span>,
    drink: <span class="hljs-string">&apos;Milk&apos;</span>
  });
  <span class="hljs-keyword">let</span> error = badBreakfast.validateSync();
  <span class="hljs-built_in">console</span>.log(error);
  assert.equal(error.errors[<span class="hljs-string">&apos;eggs&apos;</span>].message,
    <span class="hljs-string">&apos;Too few eggs&apos;</span>);
  assert.ok(!error.errors[<span class="hljs-string">&apos;bacon&apos;</span>]);
  assert.equal(error.errors[<span class="hljs-string">&apos;drink&apos;</span>].message,
    <span class="hljs-string">&apos;`Milk` is not a valid enum value for path `drink`.&apos;</span>);

  badBreakfast.bacon = <span class="hljs-literal">null</span>;
  error = badBreakfast.validateSync();
  assert.equal(error.errors[<span class="hljs-string">&apos;bacon&apos;</span>].message, <span class="hljs-string">&apos;Why no bacon?&apos;</span>);

  mongoose.connection.close();   

})();
</code></pre>
<p>Cuando se ejecuta, este programa produce una salida como esta:</p>
<pre><code class="lang-bash">[~/javascript/mongoose/hello/mongoosevalidation(master)]$ node mongoosebuiltinvalidators.js 
{ [ValidationError: Breakfast validation failed]
  message: <span class="hljs-string">&apos;Breakfast validation failed&apos;</span>,
  name: <span class="hljs-string">&apos;ValidationError&apos;</span>,
  errors: 
   { drink: 
      { [ValidatorError: `Milk` is not a valid enum value <span class="hljs-keyword">for</span> path `drink`.]
        message: <span class="hljs-string">&apos;`Milk` is not a valid enum value for path `drink`.&apos;</span>,
        name: <span class="hljs-string">&apos;ValidatorError&apos;</span>,
        properties: [Object],
        kind: <span class="hljs-string">&apos;enum&apos;</span>,
        path: <span class="hljs-string">&apos;drink&apos;</span>,
        value: <span class="hljs-string">&apos;Milk&apos;</span> },
     eggs: 
      { [ValidatorError: Too few eggs]
        message: <span class="hljs-string">&apos;Too few eggs&apos;</span>,
        name: <span class="hljs-string">&apos;ValidatorError&apos;</span>,
        properties: [Object],
        kind: <span class="hljs-string">&apos;min&apos;</span>,
        path: <span class="hljs-string">&apos;eggs&apos;</span>,
        value: 2 } } }
</code></pre>
<h5 id="v&#xE9;ase-el-gist">V&#xE9;ase el gist</h5>
<ul>
<li><a href="https://gist.github.com/crguezl/82caad653fc2483b9d5b623536060eb0" target="_blank">gist</a></li>
</ul>
<h4 id="ejemplo-simple-de-uso-de-mongoose-con-express">Ejemplo Simple de uso de Mongoose con Express</h4>
<ul>
<li><a href="https://github.com/ULL-ESIT-GRADOII-DSI/mongo-example-todos" target="_blank">Ejemplo sacado del libro &quot;learning Web App Development&quot;</a><ul>
<li><a href="http://api.jquery.com/jquery.getjson/" target="_blank">jQuery <code>getJSON</code></a></li>
<li><a href="http://api.jquery.com/removeclass/" target="_blank">jQuery <code>removeClass</code></a></li>
<li><a href="http://api.jquery.com/trigger/" target="_blank">jQuery <code>trigger</code></a></li>
</ul>
</li>
</ul>
<h4 id="middlewares">Middlewares</h4>
<p>Middleware (also called pre and post hooks) are functions which are passed control during execution of asynchronous functions. </p>
<p>Middleware is specified on the schema level and is useful for writing plugins. </p>
<p>Mongoose 4.0 has 2 types of middleware: </p>
<ol>
<li>document middleware and </li>
<li>query middleware. </li>
</ol>
<p>Document middleware is supported for the following document functions.</p>
<ul>
<li>init</li>
<li>validate</li>
<li>save</li>
<li>remove</li>
</ul>
<p>Query middleware is supported for the following Model and Query functions.</p>
<ul>
<li>count</li>
<li>find</li>
<li>findOne</li>
<li>findOneAndRemove</li>
<li>findOneAndUpdate</li>
<li>update</li>
</ul>
<p>Both document middleware and query middleware support pre and post hooks. </p>
<ul>
<li><a href="http://mongoosejs.com/docs/middleware.html" target="_blank">Middleware</a></li>
</ul>
<h4 id="population">Population</h4>
<p>There are no joins in MongoDB but sometimes we still want references to documents in other collections. This is where population comes in. </p>
<p>Population is the process of automatically replacing the specified paths in the document with document(s) from other collection(s). </p>
<p>We may populate a single document, multiple documents, plain object, multiple plain objects, or all objects returned from a query.</p>
<pre><code class="lang-javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  &quot;use strict&quot;</span>;
  <span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;util&apos;</span>);
  <span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;mongoose&apos;</span>);

  mongoose.connect(<span class="hljs-string">&apos;mongodb://localhost/tutu&apos;</span>);

  <span class="hljs-keyword">const</span> Schema = mongoose.Schema;

  <span class="hljs-keyword">const</span> personSchema = Schema({
    name    : <span class="hljs-built_in">String</span>,
    age     : <span class="hljs-built_in">Number</span>,
    stories : [{ type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Story&apos;</span> }]
  });

  <span class="hljs-keyword">const</span> storySchema = Schema({
    _creator : { type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Person&apos;</span> },
    title    : <span class="hljs-built_in">String</span>,
    fans     : [{ type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Person&apos;</span> }]
  });

  <span class="hljs-keyword">const</span> Story  = mongoose.model(<span class="hljs-string">&apos;Story&apos;</span>, storySchema);
  <span class="hljs-keyword">const</span> Person = mongoose.model(<span class="hljs-string">&apos;Person&apos;</span>, personSchema);

  Person.remove({}).then(()=&gt;{
    Story.remove({}).then( () =&gt; {
      <span class="hljs-keyword">let</span> aaron = <span class="hljs-keyword">new</span> Person({ name: <span class="hljs-string">&apos;Aaron&apos;</span>, age: <span class="hljs-number">100</span> });

      aaron.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
        <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err);

        <span class="hljs-keyword">let</span> story1 = <span class="hljs-keyword">new</span> Story({
          title: <span class="hljs-string">&quot;Once upon a timex.&quot;</span>,
          _creator: aaron._id    <span class="hljs-comment">// assign the _id from the person</span>
        });

        story1.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
          <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err);
          <span class="hljs-comment">// thats it!</span>
        }).then(()=&gt;{

          Story
          .findOne({ title: <span class="hljs-string">&apos;Once upon a timex.&apos;</span> })
          .populate(<span class="hljs-string">&apos;_creator&apos;</span>)
          .exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, story</span>) </span>{
            <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err);
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;The creator is %s&apos;</span>, story._creator.name);
            <span class="hljs-comment">// prints &quot;The creator is Aaron&quot;</span>
          }).then( () =&gt; {
            mongoose.connection.close(); 
          });

        });
      });
    });
  });
})();
</code></pre>
<p>The <code>ref</code>  option is what tells Mongoose in which model to look when using the <code>populate</code> 
method, in our case the <code>Story</code> model:</p>
<pre><code class="lang-javascript">  <span class="hljs-keyword">const</span> personSchema = Schema({
    name    : <span class="hljs-built_in">String</span>,
    age     : <span class="hljs-built_in">Number</span>,
    stories : [{ type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Story&apos;</span> }]
  });
</code></pre>
<ul>
<li>We&apos;ve created two Models. </li>
<li>Our <code>Person</code> model has its stories field set to an array of <code>ObjectId</code>s and <code>refs</code>. </li>
<li>The <code>ref</code> option is what tells Mongoose which model to use when calling <code>populate</code>, 
in our case the <code>Story</code> model. </li>
<li>All <code>_id</code>s we store here must be document <code>_id</code>s from the <code>Story</code> model. </li>
<li>We also declared the <code>Story</code> <code>_creator</code> property as a <code>ObjectId</code>, 
the same type as the default <code>_id</code> used in the <code>personSchema</code>. <pre><code class="lang-javascript">  <span class="hljs-keyword">const</span> storySchema = Schema({
    _creator : { type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Person&apos;</span> },
    title    : <span class="hljs-built_in">String</span>,
    fans     : [{ type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Person&apos;</span> }]
  });
</code></pre>
</li>
<li>Populated paths are no longer set to their original <code>_id</code> , their value is replaced with the mongoose document returned from the database by performing a separate query before returning the results.<pre><code class="lang-javascript">        Story
        .findOne({ title: <span class="hljs-string">&apos;Once upon a timex.&apos;</span> })
        .populate(<span class="hljs-string">&apos;_creator&apos;</span>)
        .exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, story</span>) </span>{
          <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err);
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;The creator is %s&apos;</span>, story._creator.name);
          <span class="hljs-comment">// prints &quot;The creator is Aaron&quot;</span>
        }).then( () =&gt; {
</code></pre>
</li>
<li>Arrays of refs work the same way. Just call the <a href="http://mongoosejs.com/docs/api.html#query_Query-populate" target="_blank">populate</a>
method on the query and an array of documents will be returned in place of the original <code>_id</code>s.</li>
<li><p>It is important to match the type of <code>_id</code> to the type of <code>ref</code> (see this <a href="https://gist.github.com/crguezl/06cef7cb8078a78a84bc0a28b8e014f8#file-mongoosepopulation-js-L10-L21" target="_blank">example</a>):</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> personSchema = Schema({
  _id     : <span class="hljs-built_in">Number</span>,
  name    : <span class="hljs-built_in">String</span>,
  age     : <span class="hljs-built_in">Number</span>,
  stories : [{ type: Schema.Types.ObjectId, ref: <span class="hljs-string">&apos;Story&apos;</span> }]
});

<span class="hljs-keyword">const</span> storySchema = Schema({
  _creator : { type: <span class="hljs-built_in">Number</span>, ref: <span class="hljs-string">&apos;Person&apos;</span> },
  title    : <span class="hljs-built_in">String</span>,
  fans     : [{ type: <span class="hljs-built_in">Number</span>, ref: <span class="hljs-string">&apos;Person&apos;</span> }]
});
</code></pre>
</li>
<li><p>Saving refs to other documents works the same way you normally save properties, just assign the <code>_id</code> value:</p>
<pre><code class="lang-javascript">        <span class="hljs-keyword">let</span> story1 = <span class="hljs-keyword">new</span> Story({
          title: <span class="hljs-string">&quot;Once upon a timex.&quot;</span>,
          _creator: aaron._id    <span class="hljs-comment">// assign the _id from the person</span>
        });

        story1.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
          <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(err);
          <span class="hljs-comment">// thats it!</span>
        }).then(()=&gt;{ ...
</code></pre>
</li>
<li><p><a href="https://gist.github.com/crguezl/06cef7cb8078a78a84bc0a28b8e014f8" target="_blank">gist with the examples</a></p>
</li>
</ul>
<h5 id="setting-populated-fields-simply-assign-the-object">Setting Populated Fields: Simply Assign the Object</h5>
<p>In Mongoose &gt;= 4.0, you can directly populate a field by simply assigning the object:</p>
<pre><code class="lang-javascript">Story.findOne({ title: <span class="hljs-string">&apos;Once upon a timex.&apos;</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, story</span>) </span>{
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> handleError(error);
  }
  story._creator = aaron;
  <span class="hljs-built_in">console</span>.log(story._creator.name); <span class="hljs-comment">// prints &quot;Aaron&quot;</span>
});
</code></pre>
<p>Instead of writing:</p>
<pre><code class="lang-javascript">        <span class="hljs-keyword">let</span> story1 = <span class="hljs-keyword">new</span> Story({
          title: <span class="hljs-string">&quot;Once upon a timex.&quot;</span>,
          _creator: aaron._id    <span class="hljs-comment">// assign the _id from the person</span>
        });
</code></pre>
<ul>
<li>Note that this only works for single refs. </li>
<li>You currently can&apos;t manually populate an array of refs.</li>
</ul>
<h5 id="field-selection">Field selection</h5>
<p>What if we only want a few specific fields returned for the populated
documents? This can be accomplished by passing the usual 
<a href="http://mongoosejs.com/docs/api.html#query_Query-select" target="_blank">field name syntax</a> 
as the second argument to the populate method:</p>
<pre><code class="lang-javascript">Story
.findOne({ title: <span class="hljs-regexp">/timex/i</span> })
.populate(<span class="hljs-string">&apos;_creator&apos;</span>, <span class="hljs-string">&apos;name&apos;</span>) <span class="hljs-comment">// only return the Persons name</span>
.exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, story</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;The creator is %s&apos;</span>, story._creator.name);
  <span class="hljs-comment">// prints &quot;The creator is Aaron&quot;</span>

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;The creators age is %s&apos;</span>, story._creator.age);
  <span class="hljs-comment">// prints &quot;The creators age is null&apos;</span>
})
</code></pre>
<p>or using the <code>select</code> field in the object  query  (also known as the query &quot;projection&quot;):</p>
<pre><code class="lang-javascript">                Story
                .findOne({ title: <span class="hljs-regexp">/timex/i</span> })
                .populate({ path: <span class="hljs-string">&apos;_creator&apos;</span>, select: <span class="hljs-string">&apos;name&apos;</span> })
                .exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, story</span>) </span>{
                  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;The creator is %s&apos;</span>, story._creator.name)
                }).then( () =&gt; { ...
</code></pre>
<ul>
<li>When using string syntax, prefixing a path with - will flag that
path as excluded. </li>
<li>When a path does not have the - prefix, it is
included. </li>
<li>Lastly, if a path is prefixed with +, it forces inclusion
of the path, which is useful for paths excluded at the <a href="http://mongoosejs.com/docs/api.html#schematype_SchemaType-select" target="_blank">schema level</a> which sets the default <code>select()</code> behavior.</li>
</ul>
<h5 id="populating-multiple-paths">Populating multiple paths</h5>
<p>What if we wanted to populate multiple paths at the same time?</p>
<pre><code class="lang-javascript">Story
.find(...)
.populate(<span class="hljs-string">&apos;fans _creator&apos;</span>) <span class="hljs-comment">// space delimited path names</span>
.exec()
</code></pre>
<ul>
<li>In mongoose &gt;= 3.6, we can pass a space delimited string of path
names to populate. </li>
<li>Before 3.6 you must execute the populate() method
multiple times.</li>
<li>V&#xE9;ase por ejemplo <a href="https://gist.github.com/crguezl/06cef7cb8078a78a84bc0a28b8e014f8#file-mongoosepopulationwithfans-js-L43-L50" target="_blank">mongoosepopulationwithfans.js</a></li>
</ul>
<pre><code class="lang-javascript">Story
.find(...)
.populate(<span class="hljs-string">&apos;fans&apos;</span>)
.populate(<span class="hljs-string">&apos;_creator&apos;</span>)
.exec()
</code></pre>
<h5 id="query-conditions-and-other-options">Query conditions and other options</h5>
<p>What if we wanted to populate our fans array based on their age, select just their names, and return at most, any 5 of them?</p>
<pre><code class="lang-javascript">Story
.find(...)
.populate({
  path: <span class="hljs-string">&apos;fans&apos;</span>,
  match: { age: { $gte: <span class="hljs-number">21</span> }},
  select: <span class="hljs-string">&apos;name -_id&apos;</span>,
  options: { limit: <span class="hljs-number">5</span> }
})
.exec()
</code></pre>
<ul>
<li>V&#xE9;ase <a href="https://gist.github.com/crguezl/06cef7cb8078a78a84bc0a28b8e014f8#file-mongoosepopulationconditions-js-L46-L53" target="_blank">mongoosepopulationconditions.js</a></li>
</ul>
<h5 id="refs-to-children">Refs to children</h5>
<p>We may find however, if we use the <code>aaron</code> object, we are unable to get a list of the stories. This is because no story objects were ever &apos;pushed&apos; onto <code>aaron.stories</code>.</p>
<p>There are two perspectives here. First, it&apos;s nice to have aaron know which stories are his.</p>
<pre><code class="lang-javascript">aaron.stories.push(story1);
aaron.save(callback);
This allows us to perform a find and populate combo:
</code></pre>
<pre><code class="lang-javascript">Person
.findOne({ name: <span class="hljs-string">&apos;Aaron&apos;</span> })
.populate(<span class="hljs-string">&apos;stories&apos;</span>) <span class="hljs-comment">// only works if we pushed refs to children</span>
.exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, person</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
  <span class="hljs-built_in">console</span>.log(person);
})
</code></pre>
<p>It is debatable that we really want two sets of pointers as they may get out of sync. Instead we could skip populating and directly <code>find()</code> the stories we are interested in.</p>
<pre><code class="lang-javascript">Story
.find({ _creator: aaron._id })
.exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, stories</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> handleError(err);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;The stories are an array: &apos;</span>, stories);
})
</code></pre>
<ul>
<li>V&#xE9;ase <a href="https://gist.github.com/crguezl/06cef7cb8078a78a84bc0a28b8e014f8#file-mongoosepopulationstories-js" target="_blank">mongoosepopulationstories.js</a></li>
</ul>
<h5 id="populate-v&#xE9;ase">Populate: V&#xE9;ase</h5>
<ul>
<li><a href="http://mongoosejs.com/docs/populate.html" target="_blank">Mongoose Populate</a></li>
<li><a href="http://mongoosejs.com/docs/2.7.x/docs/populate.html" target="_blank">Mongoose Populate 2.7</a></li>
<li><a href="http://frontendcollisionblog.com/mongodb/2016/01/24/mongoose-populate.html" target="_blank">Understanding Mongoose Deep Population</a></li>
</ul>
<h4 id="tutoriales-sobre-mongoose">Tutoriales sobre Mongoose</h4>
<ul>
<li><a href="https://scotch.io/tutorials/using-mongoosejs-in-node-js-and-mongodb-applications" target="_blank">Easily Develop Node.js and MongoDB Apps with Mongoose</a></li>
</ul>

                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="mongodb.html" class="navigation navigation-prev " aria-label="Previous page: MongoDB">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../../../repasos/" class="navigation navigation-next " aria-label="Next page: Repasos">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Mongoose","level":"1.3.16.3.2","depth":4,"next":{"title":"Repasos","level":"1.4","depth":1,"path":"repasos/README.md","ref":"repasos/README.md","articles":[]},"previous":{"title":"MongoDB","level":"1.3.16.3.1","depth":4,"path":"apuntes/db/mongo/mongodb.md","ref":"apuntes/db/mongo/mongodb.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include","-autocover","-layout","youtube","video","highlight","sectionx","code-highlighter","-ace","copy-code-button","page-toc","-toc","-latex-codecogs","-emphasize","collapsible-menu","-jazer"],"root":"txt","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"code-highlighter":{},"collapsible-menu":{},"youtube":{},"include":{},"toc":{"addClass":"true","className":"toc"},"search":{"maxIndexSize":1000000},"autocover":{"title":"Apuntes del Curso 2016/2017: Procesadores de Lenguajes, Desarrollo de Sistemas Informáticos y Sistemas y Tecnologías Web","author":"Casiano","pluginsConfig":{"autocover":{"font":{"size":null,"family":"Impact","color":"#FFF"},"size":{"w":1800,"h":2360},"background":{"color":"#09F"}}}},"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4"},"layout":{"headerPath":"layouts/header.html","footerPath":"layouts/footer.html"},"lunr":{"maxIndexSize":1000000},"fontsettings":{"theme":"white","family":"sans","size":2},"sectionx":{},"highlight":{},"copy-code-button":{},"video":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"apuntes/db/mongo/mongoose.md","mtime":"2016-11-03T12:41:19.000Z","type":"markdown"},"gitbook":{"version":"3.1.1","time":"2016-11-16T13:26:05.823Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sectionx/sectionx.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    

    </body>
</html>

